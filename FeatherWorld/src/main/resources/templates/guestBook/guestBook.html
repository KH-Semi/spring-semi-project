<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title th:text="#{app.name}">Feathers McGrew Semi Project</title>

    <th:block th:replace="~{common/common}"></th:block>
    <link rel="stylesheet" href="/css/guestBook/guestBook.css" />
  </head>
  <body>
    <div class="container">
      <!-- 헤더 Include -->
      <th:block th:replace="~{common/header}"></th:block>

      <div class="content-container">
        <!-- 좌측 석준이가 만든 프로필 들어올 공간 Include -->
        <th:block th:replace="~{board/boardTypeSidebar}"></th:block>

        <!-- 중앙 방명록 목록 -->
        <div class="main-content">
          <div class="guestbook-list" id="guestbook-list">
            <!-- DB에서 가져온 방명록 목록 순회 -->
            <div
              class="guestbook-item"
              th:each="guestBook : ${guestBookList} "
              th:object="${guestBook}"
            >
              <div class="guestbook-wrap">
                <div class="guestbook-main">
                  <div class="guestbook-content" th:text="*{guestBookContent}">
                    방명록 내용
                  </div>
                </div>
              </div>
              <div class="guestbook-info">
                <span th:text="${loginMember.memberName}">작성자</span>

                <!-- <span th:text="*{visitorName}">작성자</span> -->
                <!-- guestBook 작성자 필드명에 맞춰 수정 -->
                <div class="guestbook-date" th:text="*{guestBookWriteDate}">
                  게시일
                </div>

                <!-- 로그인한 회원이 방명록 작성자일 때만 버튼 출력 -->
                <div class="guestbook-actions">
                  <th:block
                    th:if="${loginMember != null} and ${loginMember.memberNo} == *{visitorNo}"
                  >
                    <button
                      th:onclick="|showUpdateGuestBook(*{guestBookNo}, this)|"
                    >
                      Edit
                    </button>
                    <button th:onclick="|deleteGuestBook(*{guestBookNo})|">
                      Delete
                    </button>
                  </th:block>
                </div>
              </div>
            </div>
          </div>

          <!-- 페이징 처리 -->
          <div
            class="pagination"
            th:if="${pagination != null}"
            th:object="${pagination}"
          >
            <a th:href="@{/guestbook(cp=1)}">&lt;&lt;</a>
            <a th:href="@{/guestbook(cp=*{prevPage})}" class="page-nav">&lt;</a>

            <th:block
              th:if="*{startPage <= endPage}"
              th:each="i : *{#numbers.sequence(startPage, endPage)}"
            >
              <a
                th:href="@{/guestbook(cp=${i})}"
                th:text="${i}"
                th:class="${i} == *{currentPage} ? 'current' : ''"
              ></a>
            </th:block>

            <a th:href="@{/guestbook(cp=*{nextPage})}" class="page-nav">&gt;</a>
            <a th:href="@{/guestbook(cp=*{maxPage})}">&gt;&gt;</a>
          </div>

          <!-- 방명록 작성 부분 -->
          <div class="guestBook-write-area">
            <input
              type="hidden"
              id="loginMemberNo"
              th:value="${loginMember?.memberNo}"
            />
            <input type="hidden" id="ownerNo" th:value="${ownerNo}" />
            <!-- 아이콘 -->
            <div class="icon-bar">
              <i class="fa-solid fa-lock-open"></i>
              <i class="fa-solid fa-toggle-on"></i>
              <br />
            </div>
            <textarea
              class="guestBook-textbox"
              id="guestBookContent"
              placeholder="방명록을 작성해보세요 :)"
              required
            ></textarea>
            <!-- 글쓰기 버튼 -->

            <button id="addGuestBook">Write✏️</button>
          </div>
        </div>
        <!-- /.main-content -->

        <!-- 우측 네비게이션 바 Include -->
        <th:block th:replace="~{common/navSidebar}"></th:block>
      </div>

      <!-- 푸터 Include -->
      <th:block th:replace="~{common/footer}"></th:block>
    </div>

    <script src="/js/guestBook/guestBook.js"></script>
  </body>
</html>
